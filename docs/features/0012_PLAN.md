Complete the authenticated upload UX and “My Menus” list

Description
- Implement authenticated uploads in `ui/src/pages/PublicUpload.tsx` (remove TODOs) so signed-in users use protected endpoints and see a clear success flow.
- Add a “My Menus” list under `/dashboard/menu-insights` that shows the user’s menus and latest parse/analysis states.
- Provide a protected document-status polling endpoint and client polling to reflect real-time processing.

Relevant backend files/endpoints
- `server/src/api.ts`
  - Protected routes already include:
    - `POST /api/v1/protected/upload-menu` (returns `{ success, menuId, documentId, ... }`)
    - `POST /api/v1/protected/menus/parse-url` (returns `{ success, menuId, documentId, ... }`)
    - `GET  /api/v1/protected/menus` (lists user menus)
    - `GET  /api/v1/protected/menus/:id` (menu detail + recommendations)
  - Public document-status endpoint exists:
    - `GET /api/v1/documents/:documentId/status`
  - Add a protected alias with auth/authorization checks:
    - `GET /api/v1/protected/documents/:id/status`
- `server/src/schema/menus.ts`
  - Add column `documentId` to `menu_uploads` to link menus to the unified `documents` model.
- `server/src/schema/documents.ts`
  - Already defines `documents`, `parse_runs`, `analysis_runs` used by the status endpoint.
- `server/src/middleware/auth.ts`
  - No change; reused to authorize `GET /api/v1/protected/documents/:id/status` and to ensure document/user ownership.

Backend edits
1) Data model: link menus to documents
   - Schema: add optional `documentId: text('document_id').references(() => documents.id, { onDelete: 'set null' })` to `menuUploads` in `server/src/schema/menus.ts`.
   - Migration: create a new Drizzle SQL migration to `ALTER TABLE app.menu_uploads ADD COLUMN document_id text NULL;` and add the FK constraint to `app.documents(id)`.

2) Populate `documentId` when creating menus
   - `POST /api/v1/protected/upload-menu` (in `server/src/api.ts`): after `triageDocument(...)` returns `documentId`, update the newly created `menu_uploads` row to set `document_id = triage.documentId` (or insert with it if convenient).
   - `POST /api/v1/protected/menus/parse-url`: same update to persist `document_id` for the created `menu_uploads` row.
   - Optional: Set `document_id` for public endpoints too for consistency.

3) Protected document-status endpoint
   - Add `GET /api/v1/protected/documents/:id/status` under `protectedRoutes` in `server/src/api.ts`.
   - Logic: identical to existing public `/api/v1/documents/:documentId/status`, but:
     - Authenticate via `authMiddleware`.
     - Verify the `documents.userId` equals `c.get('user').id`. If not, return 404 (or 403) to avoid information leaks.
   - Response shape (same as public):
     - `{ document: { id, status, statusReason, documentType, sourceType, createdAt, updatedAt }, parseRun: { ... } | null, analysisRun: { ... } | null }`.

4) Enrich `GET /api/v1/protected/menus` with latest statuses (optional but recommended)
   - If `menu_uploads.document_id` is set, fetch the latest `parse_runs` and `analysis_runs` for that `document_id` and add to each menu payload:
     - `documentId`, `latestParseStatus`, `latestAnalysisStatus`, `lastUpdatedAt` (max of parse/analysis completedAt), and optionally `analysisMetrics` (lightweight).
   - Keep existing fields but continue to sanitize `analysisData` to exclude any raw file bytes.

Relevant frontend files
- `ui/src/pages/PublicUpload.tsx`
- `ui/src/pages/MenuInsights.tsx` (or create a new `ui/src/pages/MyMenus.tsx`)
- `ui/src/components/MenuUpload.tsx`
- `ui/src/components/UrlUpload.tsx`
- `ui/src/lib/serverComm.ts`
- `ui/src/App.tsx`

Frontend edits
1) Authenticated upload in PublicUpload
   - File upload path:
     - When `user` is present, call `api.uploadMenu({ file: { name, size, type, content: base64 } })` instead of throwing the TODO error.
     - Expect response containing `{ success, menuId, documentId }`.
     - Start status polling using the new `getDocumentStatus(documentId)` (see item 3), updating local UI states until parsing/analysis reaches a terminal state.
     - On success, set success message: “Upload successful! Check your dashboard for analysis results.” and show a button to “Go to My Menus” → navigate(`/dashboard/menu-insights`).
   - URL upload path:
     - When `user` is present, call `api.uploadMenuUrl({ url, restaurant: {...minimal fields if available...} })`.
     - Poll status using returned `documentId` as above; present similar success UX.
   - For non-authenticated users, keep current public reCAPTCHA flow and redirect to `/restaurant-details/:uploadId`.

2) My Menus page under /dashboard/menu-insights
   - Option A (minimal change): Reuse `MenuInsights` and default it to a “My Menus” listing view (current History tab) with improved layout and copy. Ensure it loads via `api.getUserMenus()` and renders status badges using the server-provided per-menu status fields if implemented (or derive from `menu.status` as a fallback).
   - Option B (clean separation): Create `ui/src/pages/MyMenus.tsx` to list menus and their statuses; keep `MenuInsights` for analytics overview and upload flows. Update routes so `/dashboard/menu-insights` → `MyMenus`, and `/dashboard/menu-insights/upload` → `MenuInsights` (or vice versa), linking between them.
   - Row fields to show: filename or source URL, created date, `status` (with color badges), and if available `latestParseStatus` / `latestAnalysisStatus` and “Updated” timestamp. Include a CTA to “Upload PDF” and “Parse URL” linking to upload screen.

3) Status polling utility
   - `ui/src/lib/serverComm.ts`:
     - Add `getDocumentStatus(documentId: string)` that calls `GET /api/v1/protected/documents/:id/status` (auth header via existing fetchWithAuth).
   - Create a small polling helper/hook (e.g., `useDocumentStatusPoll(documentId, { intervalMs = 3000, maxWaitMs = 300000 })`). Algorithm:
     1. Start with interval = 3s (or exponential backoff up to 10–15s).
     2. Re-fetch until parseRun.status is `completed` or `failed`. If `completed`, check analysisRun. If analysisRun exists, wait for `completed` or `failed` too.
     3. Stop polling if the overall document status transitions to a terminal state or `maxWaitMs` exceeded.
     4. Return status state and timestamps; expose a `stop()` and `refresh()`.
   - Use this in `PublicUpload` after authenticated uploads, and optionally in `MenuUpload`/`UrlUpload` to reflect live progress.

4) MenuUpload/UrlUpload callbacks
   - Extend both components to accept an optional `onUploadStarted({ documentId, menuId })` callback. When the protected upload returns, invoke this to allow parent pages to start polling.
   - For now, `PublicUpload` will own the authenticated calls and start polling directly to keep scope tight; adding the callback keeps future flexibility for `MenuInsights`.

5) Routing/UI wiring
   - `ui/src/App.tsx`:
     - Ensure `/dashboard/menu-insights` renders the “My Menus” list (either reused `MenuInsights` in list mode or new `MyMenus` page).
     - Keep `/dashboard/menu-insights/upload` mapped to the upload/overview screen so users can easily add new menus.
   - If using two pages, add navigation links between them (“View My Menus” ↔ “Upload/Analyze”).

API response contracts (post-change)
- `GET /api/v1/protected/menus`
  - `{ success: true, menus: Array<{ id, originalFileName, fileName, status, createdAt, updatedAt, documentId?, latestParseStatus?, latestAnalysisStatus?, lastUpdatedAt?, analysisData? (sanitized) }>} 
  - Note: `analysisData` remains sanitized; large/raw bytes are omitted.
- `GET /api/v1/protected/documents/:id/status`
  - `{ document: { id, status, statusReason, documentType, sourceType, createdAt, updatedAt }, parseRun: {...}|null, analysisRun: {...}|null }`

Edge cases
- Enforce 10MB file size limit on the client for faster feedback; surface API 413 with a clear message.
- Gracefully handle `429` (rate limit) on public flows.
- If `documentId` is missing in an old record, fall back to legacy `menu.status` and hide live status.

Test plan
- Backend
  - Create/upload a menu (auth): verify `menu_uploads.document_id` is set; `GET /api/v1/protected/menus` includes the new fields.
  - Call `GET /api/v1/protected/documents/:id/status` with matching user: expect 200; with a different user: expect 404/403.
  - Public endpoints continue to function unchanged.
- Frontend
  - Authenticated upload via `PublicUpload` completes without TODO errors, shows success, and routes to dashboard.
  - “My Menus” renders a list for the logged-in user and updates statuses on refresh/poll.
  - Status polling stops when runs complete or on timeout; errors are shown if parsing fails.


